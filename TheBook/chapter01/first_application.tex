
%使用xelatex编译
%版权所有，翻版必究
%本文件由程序自动生成，任何修改将被覆盖
%2019 年 01 月 09 日




%

\FloatBarrier
\subsection{
第一个程序
}\label{s100210}


\FloatBarrier
\subsubsection{
本书的工程项目
}\label{ss001u10}


读者可以使用Qt Creator打开“QtQmlBook.pro”。
在Windows平台下，读者
也可以修改“build\underline{\hspace{0.5em}}msvc.bat”，从而使用Visual Studio。

如\lstlistingname\ \ref{f000018} ：


%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000018,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
call "C:/Qt/Qt5.12.0/5.12.0/msvc2017_64/bin/qtenv2.bat"
cd /D "E:/QtQmlBookMsvc"
qmake -r -tp vc "E:/QtQmlBook/QtQmlBook.pro"
qmake -r -tp vc "E:/QtQmlBook/QtQmlMultimedia.pro"
qmake -r -tp vc "E:/QtQmlBook/QtQmlBookTest.pro"
qmake -r -tp vc "E:/QtQmlBook/TheBook/TheBook.pro"
cmd
\end{lstlisting}          %抄录环境
%\end{spacing}



\begin{itemize}

\item 第1行用于设置Qt运行环境；
\item 第2行用于设置Visual Studio工程文件输出目录；
\item 第3\raisebox{0.16ex}{\sourcefonttwo\~{}}6行用于指明将哪些qmake项目转为Visual Studio项目；

\end{itemize}

运行完上述命令后，读者即可使用Visual Studio打
开“QtQmlBook.sln”

本节示例代码位于文件夹“QtQmlBook/chapter01/firstapplication”下。

\lstlistingname\ \ref{f000019}
展示了
该项目的工程文件。

\begin{itemize}
\item 第11行引入“outdirpath.pri”文件，此文件定义了输出路径。
\item 第13行引入“cplusplus.pri”文件，此文件定义了标准C{\sourcefonttwo{}+}{\sourcefonttwo{}+}相关控制项。
\item 第15行引入“import\underline{\hspace{0.5em}}sstd\underline{\hspace{0.5em}}library.pri”文件，此文件引入“sstd\underline{\hspace{0.5em}}library”库。
“sstd\underline{\hspace{0.5em}}library”库用于引入和补充标准C{\sourcefonttwo{}+}{\sourcefonttwo{}+}库。
\item 第17行引入“import\underline{\hspace{0.5em}}sstd\underline{\hspace{0.5em}}qt\underline{\hspace{0.5em}}and\underline{\hspace{0.5em}}qml\underline{\hspace{0.5em}}library.pri”文件，
此文件引入“sstd\underline{\hspace{0.5em}}qt\underline{\hspace{0.5em}}and\underline{\hspace{0.5em}}qml\underline{\hspace{0.5em}}library”库。
“sstd\underline{\hspace{0.5em}}qt\underline{\hspace{0.5em}}and\underline{\hspace{0.5em}}qml\underline{\hspace{0.5em}}library”库用于引入和补充Qt库。
\item 第44\raisebox{0.16ex}{\sourcefonttwo\~{}}48行将Qml文件加入工程。这是一种惯用法，用于实现Qml国际化。
\end{itemize}

本书的所有工程项目大同小异，以后不再赘述。

%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000019,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
#firstapplication.pro
TEMPLATE = app

CONFIG(debug,debug|release){
    TARGET = firstapplication_debug
}else{
    TARGET = firstapplication
}

#define out put dir
include($$PWD/../../outdirpath.pri)
#define cplusplus environment
include($$PWD/../../cplusplus.pri)
#import sstd_library
include($$PWD/../../sstd_library/import_sstd_library.pri)
#import sstd_qt_and_qml_library
include($$PWD/../../sstd_qt_and_qml_library/import_sstd_qt_and_qml_library.pri)

!win32 {
    QMAKE_LFLAGS += -Wl,-rpath .
}

win32-msvc*{
    CONFIG += console
}

DEFINES += CURRENT_DEBUG_PATH=\\\"$$PWD\\\"

DESTDIR = $${RootDestDir}

SOURCES += $$PWD/main.cpp

CONFIG(debug,debug|release){
    QMAKE_POST_LINK += $${DESTDIR}/build_install_debug $$PWD "myqml"
}else{
    QMAKE_POST_LINK += $${DESTDIR}/build_install $$PWD "myqml"
}
export(QMAKE_POST_LINK)

QMLSOURCES += $$PWD/myqml/firstapplication/main1.qml
QMLSOURCES += $$PWD/myqml/firstapplication/main2.qml
QMLSOURCES += $$PWD/myqml/firstapplication/main3.qml

lupdate_only{
    SOURCES += $$QMLSOURCES
}

DISTFILES += $$QMLSOURCES
\end{lstlisting}          %抄录环境
%\end{spacing}


%设置Qt Quick运行参数
\FloatBarrier
\subsubsection{
Qt Quick运行常用参数设置
}\label{ss001v10}


%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000026,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main4.qml
%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000027,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main5.qml
%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000028,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main6.qml
%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000029,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main7.qml

%\begin{spacing}{1.0}
\begin{lstlisting}[label=f00002u,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
QT += gui
QT += qml
QT += core
QT += quick
QT += widgets
QT += concurrent
QT += quickwidgets
QT += quickcontrols2
\end{lstlisting}          %抄录环境
%\end{spacing}
 %import_sstd_qt_and_qml_library.1.pri

\FloatBarrier
\subsubsection{
使用QQuickView加载Qt Quick程序
}\label{ss001010}

%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000020,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
,firstnumber=67]
beforeApplication();
QGuiApplication varApp{ argc,argv };
afterApplication();
QQuickView varView;
varView.setResizeMode(QQuickView::ResizeMode::SizeViewToRootObject);
#ifdef _DEBUG
varView.setSource(
    getLocalFileFullPath(
        QStringLiteral("myqml/firstapplication/main1.qml"),
        CURRENT_DEBUG_PATH));
#else
varView.setSource(
    getLocalFileFullPath(
        QStringLiteral("myqml/firstapplication/main1.qml"),
        qApp->applicationDirPath()));
#endif
if (varView.status() != QQuickView::Status::Ready) {
    qWarning() << QStringLiteral("can not load : main1.qml");
    return -1;
}
varView.show();
return varApp.exec();
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main.cpp
%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000023,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
/*main1.qml*/
import QtQuick 2.9

Rectangle{

    width: 512 ;
    height: 512 ;
    color: Qt.rgba(1,0,0,1);

}/*Rectangle*/
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main1.qml

\FloatBarrier
\subsubsection{
使用QQuickWidget加载Qt Quick程序
}\label{ss001110}

%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000021,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
,firstnumber=90]
beforeApplication();
QApplication varApp{ argc,argv };
afterApplication();
QQuickWidget varWidget;
varWidget.setResizeMode(QQuickWidget::ResizeMode::SizeViewToRootObject);
#ifdef _DEBUG
varWidget.setSource(getLocalFileFullPath(
    QStringLiteral("myqml/firstapplication/main2.qml"),
    CURRENT_DEBUG_PATH));
#else
varWidget.setSource(getLocalFileFullPath(
    QStringLiteral("myqml/firstapplication/main2.qml"),
    qApp->applicationDirPath()));
#endif
if (varWidget.status() != QQuickWidget::Status::Ready) {
    qWarning() << QStringLiteral("can not load : main2.qml");
    return -1;
}
varWidget.show();
return varApp.exec();
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main.cpp
%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000024,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
/*main2.qml*/
import QtQuick 2.9

Rectangle{

    width: 512 ;
    height: 512 ;
    color: Qt.rgba(1,0,0,1);

/*begin:debug*/
    border.width: 9 ;
/*end:debug*/


}/*Rectangle*/
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main2.qml

\FloatBarrier
\subsubsection{
使用QQmlApplicationEngine加载Qt Quick程序
}\label{ss001210}

%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000022,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
,firstnumber=111]
beforeApplication();
QGuiApplication varApp{ argc,argv };
afterApplication();
#ifdef _DEBUG
QQmlApplicationEngine varEngine(getLocalFileFullPath(
    QStringLiteral("myqml/firstapplication/main3.qml"),
    CURRENT_DEBUG_PATH));
#else
QQmlApplicationEngine varEngine(getLocalFileFullPath(
    QStringLiteral("myqml/firstapplication/main3.qml"),
    qApp->applicationDirPath()));
#endif
if (varEngine.rootObjects().isEmpty()) {
    qWarning() << QStringLiteral("can not load : main3.qml");
    return -1;
}
return varApp.exec();
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main.cpp
%\begin{spacing}{1.0}
\begin{lstlisting}[label=f000025,
caption=GoodLuck,
title=\lstlistingname\ \thelstlisting
]
/*main3.qml*/
import QtQuick 2.9
import QtQuick.Window 2.2

Window {

    width: 512 ;
    height: 512 ;
    visible: true ;

    Rectangle{
        anchors.fill: parent ;
        color: Qt.rgba(1,0,0,1);

        /*begin:debug*/
        border.width: 9 ;
        /*end:debug*/

    }/*Rectangle*/

}
\end{lstlisting}          %抄录环境
%\end{spacing}
 %main3.qml
































%使用xelatex编译
%版权所有，翻版必究
%本文件由程序自动生成，任何修改将被覆盖
%2019 年 01 月 09 日



